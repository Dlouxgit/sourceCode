{"version":3,"file":"vue.js","sources":["../src/utils.js","../src/global-api/index.js","../src/compiler/parser.js","../src/compiler/generate.js","../src/compiler/index.js","../src/observe/array.js","../src/observe/dep.js","../src/observe/index.js","../src/state.js","../src/observe/scheduler.js","../src/observe/watcher.js","../src/vdom/index.js","../src/vdom/patch.js","../src/lifecycle.js","../src/init.js","../src/render.js","../src/index.js"],"sourcesContent":["export function isFunction(val) {\r\n    return typeof val === 'function'\r\n}\r\n\r\nexport function isObject(val) {\r\n    return typeof val === 'object' && val !== null\r\n}\r\n\r\nlet callbacks = []\r\nlet waiting = false\r\n\r\nfunction flushCallBacks() {\r\n    callbacks.forEach(fn => fn())\r\n    callbacks = []\r\n    waiting = false\r\n}\r\n\r\nexport function nextTick(fn) {\r\n    callbacks.push(fn)\r\n    if (!waiting) {\r\n        waiting = true\r\n        Promise.resolve().then(flushCallBacks)\r\n    }\r\n    return \r\n}\r\n\r\nexport let isArray = Array.isArray\r\n\r\n\r\nlet strats = {}\r\n\r\nlet lifeCycle = [\r\n    'beforeCreate',\r\n    'created',\r\n    'beforeMount',\r\n    'mounted'\r\n]\r\nlifeCycle.forEach(hook => {\r\n    strats[hook] = function (parentVal, childVal) {\r\n        if (childVal) {\r\n            if (parentVal) {\r\n                return parentVal.concat(childVal)\r\n            } else { // 最开始是 {} 和父合并，因此父亲的 key 值一定会走这里变成数组，因此上面的逻辑可以用 concat\r\n                if (isArray(childVal)) {\r\n                    return childVal\r\n                } else {\r\n                    return [childVal]\r\n                }\r\n            }\r\n        } else {\r\n            return [parentVal]\r\n        }\r\n    }\r\n})\r\n\r\nstrats.components = function (parentVal, childVal) {\r\n    let res = Object.create(parentVal)\r\n    if (childVal) {\r\n        for  (let key in childVal) {\r\n            res[key] = childVal[key]\r\n        }\r\n    }\r\n    return res\r\n}\r\n\r\nexport function mergeOptions(parentVal, childVal) {\r\n    console.log('parentVal, childVal', parentVal, childVal)\r\n    const options = {}\r\n\r\n    for (let key in parentVal) {\r\n        mergeFileds(key)\r\n    }\r\n\r\n    for (let key in childVal) {\r\n        if (!parentVal.hasOwnProperty(key)) {\r\n            mergeFileds(key)\r\n        }\r\n    }\r\n\r\n    function mergeFileds(key) {\r\n        let strat = strats[key]\r\n        if (strat) {\r\n            options[key] = strat(parentVal[key], childVal[key])\r\n        } else {\r\n            options[key] = childVal[key] || parentVal[key]\r\n        }\r\n    }\r\n\r\n    return options\r\n}\r\n\r\nfunction makeMap(str) {\r\n    let tagList = str.split(',')\r\n    return function(tagNmae) {\r\n        return tagList.includes(tagNmae)\r\n    }\r\n}\r\n\r\nexport const isReservedTag = makeMap('div,span,template,p,script,slot,a,image,text,view,button')","import { isObject, mergeOptions } from '../utils'\r\nexport function initGlobalAPI(Vue) {\r\n    Vue.options = {} // 全局属性，每个组件初始化时这些属性都会被放到组件上\r\n    Vue.mixin = function (options) {\r\n        this.options = mergeOptions(this.options, options)\r\n        return this\r\n    }\r\n\r\n    Vue.options._base = Vue\r\n    \r\n    Vue.extend = function (opt) {\r\n        const Super = this\r\n\r\n        const Sub = function (options) {\r\n            this._init(options)\r\n        }\r\n\r\n        Sub.prototype = Object.create(Super.prototype) // Object.create 会产生一个新的实例(new Fn(), Fn.prototype === Super.prototype)作为子类(Sub)的原型，此时 constructor 会指向错误\r\n        Sub.prototype.constructor = Sub\r\n        \r\n        Sub.options = mergeOptions(Super.options, opt)\r\n        return Sub\r\n    }\r\n\r\n    Vue.options.components = {}\r\n\r\n    Vue.component = function (id, definition) {\r\n        console.log('213213')\r\n        let  name = definition.name = definition.name || id\r\n        if (isObject(definition)) {\r\n            definition = Vue.extend(definition)\r\n        }\r\n        Vue.options.components[name] = definition\r\n    }\r\n    Vue.filter = function name() {}\r\n    Vue.directive = function name() {}\r\n}","\r\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`; // 匹配标签名的  aa-xxx\r\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`; //  aa:aa-xxx  \r\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); //  此正则可以匹配到标签名 匹配到结果的第一个(索引第一个) [1]\r\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); // 匹配标签结尾的 </div>  [1]\r\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/; // 匹配属性的\r\n\r\n// [1]属性的key   [3] || [4] ||[5] 属性的值\r\n\r\nconst startTagClose = /^\\s*(\\/?)>/; // 匹配标签结束的  />    > \r\n\r\nexport function parserHTML(html) {\r\n    let stack = []\r\n    let root = null\r\n    function createASTElement(tag, attrs, parent = null) {\r\n        return {\r\n            tag,\r\n            type: 1,\r\n            children: [],\r\n            parent,\r\n            attrs\r\n        }\r\n    }\r\n    function start(tag,attrs){ // [div,p]\r\n        // 遇到开始标签 就取栈中的最后一个作为父节点\r\n        let parent = stack[stack.length-1];\r\n        let element = createASTElement(tag,attrs,parent);\r\n        if(root == null){ // 说明当前节点就是根节点\r\n            root = element\r\n        }\r\n        if(parent){\r\n            element.parent = parent; // 跟新p的parent属性 指向parent\r\n            parent.children.push(element);\r\n        }\r\n        stack.push(element)\r\n    }\r\n    function end(tagName) {\r\n        let endTag = stack.pop()\r\n        if (endTag.tag != tagName) {\r\n            console.log('标签错误')\r\n        }\r\n    }\r\n\r\n    function text(chars) {\r\n        let parent = stack[stack.length - 1]\r\n        chars = chars.replace(/\\s/g, '')\r\n        if (chars) {\r\n            parent.children.push({\r\n                type: 2, // 文本\r\n                text: chars\r\n            })\r\n        }\r\n    }\r\n\r\n    function advance(len) {\r\n        html = html.substring(len)\r\n    }\r\n    function parseStartTag() {\r\n        const start = html.match(startTagOpen)\r\n        if (start) {\r\n            const match = {\r\n                tagName: start[1],\r\n                attrs: []\r\n            }\r\n            advance(start[0].length)\r\n            let end\r\n            let attr\r\n            while (!(end = html.match(startTagClose)) && (attr = html.match(attribute))) {\r\n                match.attrs.push({\r\n                    name: attr[1],\r\n                    value: attr[3] || attr[4] || attr[5] // 属性可能为 height=1 height=\"1\" height='1'\r\n                })\r\n                advance(attr[0].length)\r\n            }\r\n            if (end) {\r\n                advance(end[0].length)\r\n            }\r\n            return match\r\n        }\r\n        return false\r\n    }\r\n    while (html) {\r\n        let index = html.indexOf('<')\r\n        if (index === 0) {\r\n            const startTagMatch = parseStartTag()\r\n            if (startTagMatch) {\r\n                start(startTagMatch.tagName, startTagMatch.attrs)\r\n                continue\r\n            }\r\n            let endTagMatch\r\n            if (endTagMatch = html.match(endTag)) {\r\n                end(endTagMatch[1])\r\n                advance(endTagMatch[0].length)\r\n                continue\r\n            }\r\n        }\r\n        if (index > 0) {\r\n            let chars = html.substring(0, index)\r\n            text(chars)\r\n            advance(chars.length)\r\n        }\r\n    }\r\n    console.log(root)\r\n    return root\r\n}","const defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g; // {{   xxx  }}  \r\n\r\nfunction genProps(attrs) {\r\n    let str = ''\r\n\r\n    for (let i = 0; i < attrs.length; i++) {\r\n        let attr = attrs[i]\r\n        if (attr.name === 'style') {\r\n            let styles = {}\r\n            attr.value.replace(/([^;:]+):([^;:]+)/g, function() {\r\n                styles[arguments[1]] = arguments[2];\r\n            })\r\n            attr.value = styles\r\n        }\r\n        str += `${attr.name}: ${JSON.stringify(attr.value)},`\r\n    }\r\n    return `{${str.slice(0, -1)}}`\r\n}\r\n\r\nfunction gen(el) {\r\n    if (el.type === 1) {\r\n        return generate(el)\r\n    } else {\r\n        let text = el.text\r\n        if (!defaultTagRE.test(text))\r\n            return `_v('${text}')`\r\n        let lastIndex = defaultTagRE.lastIndex = 0\r\n        let tokens = []\r\n        let match\r\n        while (match = defaultTagRE.exec(text)) {\r\n            let index = match.index\r\n            if (index > lastIndex) {\r\n                tokens.push(JSON.stringify(text.slice(lastIndex, index)))\r\n            }\r\n            tokens.push(`_s(${match[1].trim()})`)\r\n            lastIndex = index + match[0].length\r\n        }\r\n        if (lastIndex < text.length) {\r\n            tokens.push(JSON.stringify(text.slice(lastIndex)))\r\n        }\r\n        return `_v(${tokens.join('+')})`\r\n    }\r\n}\r\n\r\nfunction genChildren(el) {\r\n    let children = el.children\r\n    if (children) {\r\n        return children.map(item => gen(item)).join(',')\r\n    }\r\n    return false\r\n}\r\n\r\nexport function generate(ast) {\r\n    let children = genChildren(ast)\r\n    let code = `_c('${ast.tag}', ${\r\n        ast.attrs.length ? genProps(ast.attrs) : 'undefined'\r\n    }${\r\n        children? `,${children}` : ''\r\n    })`\r\n    return code\r\n}","import { parserHTML } from './parser'\r\nimport { generate } from './generate'\r\nexport function compileToFunction(template) {\r\n    let ast = parserHTML(template)\r\n    let code = generate(ast)\r\n    let render = new Function(`with(this){return ${code}}`)\r\n    console.log('redner', render.toString())\r\n    return render\r\n}","let oldArrayPrototype = Array.prototype\r\n\r\nexport let arrayMethods = Object.create(oldArrayPrototype)\r\n\r\nlet methods = [\r\n    'push',\r\n    'shift',\r\n    'pop',\r\n    'unshift',\r\n    'reverse',\r\n    'sort',\r\n    'splice'\r\n]\r\n\r\nmethods.forEach(method => {\r\n    arrayMethods[method] = function (...args) {\r\n        oldArrayPrototype[method].call(this, ...args)\r\n\r\n        let inserted = null\r\n        let ob = this.__ob__\r\n        switch (method) {\r\n            case 'splice':\r\n                inserted =  args.slice(2)\r\n                break\r\n            case 'push':\r\n            case 'shift':\r\n                inserted = args\r\n                break\r\n        }\r\n        if (inserted) ob.observeArray(inserted)\r\n    }\r\n})","let id = 0\r\nclass Dep {\r\n    constructor(vm) {\r\n        this.vm = vm\r\n        this.id = id++\r\n        this.subs = []\r\n    }\r\n\r\n    depend() {\r\n        Dep.target.addDep(this)\r\n    }\r\n\r\n    addSub(watcher) {\r\n        this.subs.push(watcher)\r\n    }\r\n\r\n    notify() {\r\n        this.subs.forEach(item => item.update())\r\n    }\r\n}\r\n\r\nDep.target = null\r\n\r\nexport default Dep","import { isArray, isObject } from '../utils'\r\nimport { arrayMethods } from './array'\r\nimport Dep from './dep'\r\n\r\nclass Observer {\r\n    constructor(value) {\r\n        Object.defineProperty(value, '__ob__', {\r\n            value: this,\r\n            enumerable: false\r\n        })\r\n\r\n        if (isArray(value)) {\r\n            value.__proto__ = arrayMethods\r\n            this.observeArray(value)\r\n        } else {\r\n            this.walk(value)\r\n        }\r\n    }\r\n\r\n    observeArray(data) {\r\n        data.forEach(item => observe(item))\r\n    }\r\n\r\n    walk(data) {\r\n        Object.keys(data).forEach(key => {\r\n            defineReactive(data, key, data[key])\r\n        })\r\n    }\r\n}\r\n\r\nfunction defineReactive(obj, key, value) {\r\n    observe(value)\r\n\r\n    let dep = new Dep()\r\n\r\n    Object.defineProperty(obj, key, {\r\n        get() {\r\n            if (Dep.target) {\r\n                dep.depend()\r\n            }\r\n\r\n            return value\r\n        },\r\n        set(newValue) {\r\n            if (newValue === value)\r\n                return\r\n            observe(newValue)\r\n            value = newValue\r\n            dep.notify()\r\n        }\r\n    })\r\n}\r\n\r\nexport function observe(value) {\r\n    if (!isObject(value))\r\n        return\r\n    if (value.__ob__)\r\n        return\r\n    return new Observer(value)\r\n}","import { observe } from './observe'\r\nimport { isFunction } from './utils'\r\n\r\nexport function initState(vm) {\r\n    const opts = vm.$options\r\n\r\n    if (opts.data) {\r\n        initData(vm)\r\n    }\r\n}\r\n\r\nfunction proxy(vm, key, source) {\r\n    Object.defineProperty(vm, key, {\r\n        get() {\r\n            return vm[source][key]\r\n        },\r\n        set(newValue) {\r\n            vm[source][key] = newValue\r\n        }\r\n    })\r\n}\r\n\r\nfunction initData(vm) {\r\n    let data = vm.$options.data\r\n    \r\n    data = vm._data = isFunction(data) ? data.call(vm) : data\r\n\r\n    observe(data)\r\n\r\n    for (let key in data) {\r\n        proxy(vm, key, '_data')\r\n    }\r\n}","import { nextTick } from \"../utils\"\r\n\r\nlet queue = []\r\nlet has = {}\r\n\r\nfunction flushSchedulerQueue() {\r\n    queue.forEach(watcher => watcher.run())\r\n    queue = []\r\n    has = {}\r\n    pending = false\r\n}\r\n\r\nlet pending = false\r\nexport function queueWatcher(watcher) {\r\n    let id = watcher.id\r\n    if (has[id] == null) { // 0 == null toBeFalsy(),  0 == undefined toBeFalsy(),  null == undefined toBeTruthy()\r\n        has[id] = true\r\n        queue.push(watcher)\r\n        if (!pending) {\r\n            nextTick(flushSchedulerQueue)\r\n            pending = true\r\n        }\r\n    }\r\n}","import Dep from './dep'\r\nimport { queueWatcher } from './scheduler'\r\n\r\nlet id = 0\r\nclass Watcher {\r\n    constructor(vm, fn, cb, options) {\r\n        this.vm = vm\r\n        this.fn = fn\r\n        this.cb = cb\r\n        this.options = options\r\n        this.id = id++\r\n        this.depIds = new Set()\r\n        this.getter = fn\r\n        this.deps = []\r\n        this.get()\r\n    }\r\n\r\n    addDep(dep) {\r\n        let depId = dep.id\r\n        if (!this.depIds.has(depId)) {\r\n            this.depIds.add(depId)\r\n            this.deps.push(dep)\r\n            dep.subs.push(this)\r\n        }\r\n    }\r\n\r\n    get() {\r\n        Dep.target = this\r\n        this.getter()\r\n        Dep.target = null\r\n    }\r\n\r\n    update() {\r\n        queueWatcher(this)\r\n    }\r\n\r\n    run() {\r\n        console.log('渲染触发')\r\n        this.get()\r\n    }\r\n}\r\n\r\nexport default Watcher","import { isObject, isReservedTag } from '../utils'\r\n\r\nfunction createComponent(vm, tag, data, children, key, Ctor) {\r\n\r\n    if (isObject(Ctor)) {\r\n        Ctor =  vm.$options._base.extend(Ctor)\r\n    }\r\n    data.hook = {\r\n        init(vnode) {\r\n            let child = vnode.componentInstance = new Ctor({})\r\n            child.$mount()\r\n        },\r\n        prepatch() {},\r\n        insert() {},\r\n        destroy() {}\r\n    }\r\n\r\n    let componentVnode = vnode(vm, tag, data, undefined, key, undefined, { Ctor, children })\r\n    return componentVnode\r\n}\r\n\r\nexport function createElement(vm, tag, data = {}, ...children) {\r\n    if (!isReservedTag(tag)) {\r\n        let Ctor = vm.$options.components[tag]\r\n        return createComponent(vm, tag, data, children, data.key, Ctor)\r\n    }\r\n\r\n    return vnode(vm, tag, data, children, data.key, undefined)\r\n}\r\n\r\nexport function createText(vm, text) {\r\n    return vnode(vm, undefined, undefined, undefined, undefined, text)\r\n}\r\n\r\nexport function isSameVnode(oldVnode, newVnode) {\r\n    return (newVnode.tag === oldVnode.tag) && (newVnode.key === oldVnode.key)\r\n}\r\n\r\nfunction vnode(vm, tag, data, children, key, text, componentOptions) {\r\n    return {\r\n        vm,\r\n        tag,\r\n        data,\r\n        children,\r\n        key,\r\n        text,\r\n        componentOptions\r\n    }\r\n}","import { isSameVnode } from \".\"\r\n\r\nexport function patch(oldVnode, vnode) {\r\n    \r\n    if (!oldVnode) {\r\n        // 没有 oldVnode 说明是组件渲染，直接返回真实节点\r\n        return createElm(vnode)\r\n    }\r\n    const isRealElement = oldVnode.nodeType\r\n\r\n    if (isRealElement) {\r\n        const elm = createElm(vnode) // 创造真实节点\r\n        const parentNode = oldVnode.parentNode\r\n        parentNode.insertBefore(elm, oldVnode.nextSibling)\r\n        parentNode.removeChild(oldVnode)\r\n        return elm\r\n    } else {\r\n        if (!isSameVnode(oldVnode, vnode)) {\r\n            createElm(vnode)\r\n            return oldVnode.el.parentNode.replaceChild(createElm(vnode), oldVnode.el)\r\n        }\r\n        let el = vnode.el = oldVnode.el\r\n        // 文本节点\r\n        if (!oldVnode.tag) {\r\n            if (!oldVnode.text !== vnode.text) {\r\n                return el.textContent = vnode.text\r\n            }\r\n        }\r\n\r\n        updateProperties(vnode, oldVnode.data)\r\n        // 元素节点\r\n        let oldChildren = oldVnode.children || []\r\n        let newChildren = vnode.children || []\r\n        if (oldChildren.length > 0 && newChildren.length === 0) { // 老节点存在子节点，新节点无\r\n            el.innerHTML = ''\r\n        } else if (newChildren.length > 0 && oldChildren.length === 0) { // 新节点存在子节点，老节点无\r\n            newChildren.forEach(child => el.appendChild(createElm(child)))\r\n        } else {\r\n            updateChildren(el, oldChildren, newChildren)\r\n        }\r\n    }\r\n}\r\n\r\n// diff O(n)\r\nfunction updateChildren(el, oldChildren, newChildren) {\r\n    let oldStartIndex = 0\r\n    let oldStartVnode = oldChildren[0]\r\n    let oldEndIndex = oldChildren.length - 1\r\n    let oldEndVnode = oldChildren[oldEndIndex]\r\n\r\n    let newStartIndex = 0\r\n    let newStartVnode = newChildren[0]\r\n    let newEndIndex = newChildren.length - 1\r\n    let newEndVnode = newChildren[newEndIndex]\r\n\r\n    function makeKeyByIndex() {\r\n        let map = {}\r\n        children.forEach((item, index) => {\r\n            map[item.key] = index\r\n        })\r\n        return map\r\n    }\r\n\r\n    let mapping = makeKeyByIndex(oldChildren)\r\n\r\n    while (oldStartIndex <= oldEndIndex && newStartIndex <= newEndIndex) {\r\n        if (!oldStartVnode) {\r\n            oldStartVnode = oldChildren[++oldStartIndex]\r\n        } else if (!oldEndVnode) {\r\n            oldEndVnode = oldChildren[--oldEndIndex]\r\n        } else if (isSameVnode(oldStartVnode, newStartVnode)) {\r\n            patch(oldStartVnode, newStartVnode)\r\n            oldStartVnode = oldChildren[++oldStartIndex]\r\n            newStartVnode = newChildren[++newStartIndex]\r\n        } else if (isSameVnode(oldEndVnode, newEndVnode)) {\r\n            patch(oldEndVnode, newEndVnode)\r\n            oldEndVnode = oldChildren[--oldEndIndex]\r\n            newEndVnode = newChildren[--newEndIndex]\r\n        } else if (isSameVnode(oldStartVnode, newEndVnode)) {\r\n            patch(oldStartVnode, newEndVnode)\r\n            el.insertBefore(oldStartVnode.el, oldEndVnode.el.nextSibling)\r\n            oldStartVnode = oldChildren[++oldStartIndex]\r\n            newEndVnode = newChildren[--newEndIndex]\r\n        } else if (isSameVnode(oldEndVnode, newStartVnode)) {\r\n            patch(oldEndVnode, newStartVnode)\r\n            el.insertBefore(oldEndVnode.el, oldStartVnode.el)\r\n            oldEndVnode = oldChildren[--oldEndIndex]\r\n            newStartVnode = newChildren[++newStartIndex]\r\n        } else {\r\n            let moveIndex = mapping[newStartVnode.key]\r\n            if (moveIndex == null) {\r\n                el.insertBefore(oldStartVnode.el, createElm(newStartVnode))\r\n            } else {\r\n                let moveVnode = oldChildren[moveIndex]\r\n                el.insertBefore(moveVnode.el, oldStartVnode.el)\r\n                patch(moveVnode, newStartVnode)\r\n                oldChildren[moveIndex] = undefined\r\n            }\r\n            newStartVnode = newChildren[++newStartIndex]\r\n        }\r\n    }\r\n    // 新的多，插入\r\n    if (newStartIndex <= newEndIndex) {\r\n        // 查看当前节点的下一个元素是否存在(是否为 null)，存在就插入到下一个元素之前(inserBefore)，否则插入到最后(appendChild)\r\n        const anchor = newChildren[newEndIndex + 1] == null ? null : newChildren[newEndIndex + 1].el\r\n        for (let i = newStartIndex; i < newEndIndex; i++) {\r\n            // insertBefore(el, null) 相当于 appendChild\r\n            // exmple\r\n            // ABCD 老\r\n            // FEABCD 新\r\n            // F 插入到 A 前，之后 E 插入到 A 前，因此是 FE ABCD\r\n            el.insertBefore(createElm(newChildren[i]), anchor)\r\n        }\r\n    }\r\n    // 老的多，删除\r\n    if (oldStartIndex <= oldEndIndex) {\r\n        for (let i = oldStartIndex; i <= oldEndIndex; i++) {\r\n            let child = oldChildren[i]\r\n            // 由于乱序比对时，移动了 oldChildren 中的节点后，原来的节点位置会变成 undefined，此时的这个节点是不应该被移除的，因为它已经被摆放到了正确的位置上\r\n            child && el.removeChild(child.el)\r\n        }\r\n    }\r\n}\r\n\r\nfunction createComponent(vnode) {\r\n    let i = vnode.data\r\n    if ((i = i.hook) && (i = i.init)) {\r\n        // 相当于如果 i.hook 存在，把 i.hook 赋值给 i\r\n        // 接着如果 i.hook.init 存在，把 i.hook.init 赋值给 i\r\n        i(vnode)\r\n    }\r\n    if (vnode.componentInstance) {\r\n        // 说明是组件\r\n        return true\r\n    }\r\n}\r\n\r\nfunction createElm(vnode) {\r\n    let { tag, data, children, text, vm } = vnode\r\n    if (typeof tag === 'string') {\r\n        if (createComponent(vnode)) {\r\n            // 返回组件的真实节点\r\n            return vnode.componentInstance.$el\r\n        }\r\n        vnode.el = document.createElement(tag)\r\n        updateProperties(vnode)\r\n        children.forEach(child => {\r\n            vnode.el.appendChild(createElm(child))\r\n        })\r\n    } else {\r\n        // text 没有 tag\r\n        vnode.el = document.createTextNode(text)\r\n    }\r\n    return vnode.el\r\n}\r\n\r\nfunction updateProperties(vnode, oldProps = {}) {\r\n    let newProps = vnode.data || {}\r\n    let el = vnode.el\r\n\r\n    let newStyle = newProps.style || {}\r\n    let oldStyle = oldProps.style || {}\r\n\r\n    for (let key in oldStyle) {\r\n        if (!newStyle[key]) {\r\n            el.style[key] = ''\r\n        }\r\n    }\r\n\r\n    for (let key in newProps) {\r\n        if (key === 'style') {\r\n            for (let key in newStyle) {\r\n                el.style[key] = newStyle[key]\r\n            }\r\n        } else {\r\n            el.setAttribute(key, newProps[key])\r\n        }\r\n    }\r\n    for (let key in oldProps) {\r\n        if (!newProps[key]) {\r\n            el.removeArttribute(key)\r\n        }\r\n    }\r\n}","import Watcher from './observe/watcher'\r\n\r\nimport { patch } from './vdom/patch'\r\n\r\nexport function mountComponent(vm) {\r\n    const updateComponent = () => {\r\n        vm._update(vm._render())\r\n    }\r\n\r\n    callHook(vm, 'beforeCreated')\r\n\r\n    new Watcher(vm, updateComponent, () => {\r\n        console.log('hook')\r\n        callHook(vm, 'created')\r\n    }, true)\r\n    callHook(vm, 'mounted')\r\n}\r\n\r\nexport function lifecycleMixin(Vue) {\r\n    Vue.prototype._update = function (vnode) {\r\n        const vm = this\r\n        let preVnode = vm._preVnode\r\n        vm._preVnode = vnode\r\n        if (!preVnode) {\r\n            vm.$el = patch(vm.$el, vnode)\r\n        } else {\r\n            vm.$el = patch(preVnode, vnode)\r\n        }\r\n    }\r\n}\r\n\r\nexport function callHook(vm, hook) {\r\n    let handlers = vm.$options[hook]\r\n    console.log(vm.$options)\r\n    console.log(handlers)\r\n    handlers && handlers.forEach(handler => {\r\n        handler.call(vm)\r\n    })\r\n}","import { compileToFunction } from './compiler'\r\nimport { initState } from './state'\r\nimport { mountComponent } from './lifecycle'\r\nimport { mergeOptions, nextTick } from './utils'\r\n\r\nexport function initMixin(Vue) {\r\n    Vue.prototype._init = function (options) {\r\n        const vm = this\r\n        vm.$options = mergeOptions(vm.constructor.options, options) // Vue 是全局的 Vue 构造函数，vm.constructor 可能是全局的 Vue，也可能是子类的构造函数，目前这里效果一样\r\n\r\n        initState(vm)\r\n\r\n        if (vm.$options.el) {\r\n            console.log('页面挂载')\r\n            vm.$mount(vm.$options.el)\r\n        }\r\n    }\r\n    Vue.prototype.$mount = function (el) {\r\n        const vm = this\r\n        const opts = vm.$options\r\n        el = document.querySelector(el)\r\n        vm.$el = el\r\n        if (!opts.render) {\r\n            // 模板编译\r\n            let template = opts.template\r\n            \r\n            if (!template) {\r\n                template = el.outerHTML\r\n            }\r\n            let render = compileToFunction(template)\r\n            opts.render = render\r\n        }\r\n        mountComponent(vm)\r\n    }\r\n    Vue.prototype.$nextTick = nextTick\r\n}\r\n","import { isObject } from './utils'\r\nimport { createElement, createText } from './vdom'\r\n\r\nexport function renderMixin(Vue) {\r\n    // 生成虚拟元素节点\r\n    Vue.prototype._c = function (...args) {\r\n        const vm = this\r\n        return createElement(vm, ...args)\r\n    }\r\n\r\n    // 生成虚拟文本节点\r\n    Vue.prototype._v = function (text) {\r\n        const vm = this\r\n        return createText(vm, text)\r\n    }\r\n\r\n    // 把属性变成字符串\r\n    Vue.prototype._s = function (val) {\r\n        if (isObject(val))\r\n            return JSON.stringify(val)\r\n        return val\r\n    }\r\n\r\n\r\n    Vue.prototype._render = function () {\r\n        const vm = this\r\n        const { render } = vm.$options\r\n        const vnode = render.call(vm)\r\n        return vnode\r\n    }\r\n}","import { initGlobalAPI } from './global-api'\r\nimport { initMixin } from './init'\r\nimport { lifecycleMixin } from './lifecycle'\r\nimport { renderMixin } from './render'\r\n\r\nfunction Vue(options) {\r\n    this._init(options)\r\n}\r\n\r\ninitMixin(Vue)\r\n\r\nrenderMixin(Vue)\r\n\r\nlifecycleMixin(Vue)\r\n\r\ninitGlobalAPI(Vue)\r\n\r\nexport default Vue"],"names":["isFunction","val","isObject","callbacks","waiting","flushCallBacks","forEach","fn","nextTick","push","Promise","resolve","then","isArray","Array","strats","lifeCycle","hook","parentVal","childVal","concat","components","res","Object","create","key","mergeOptions","console","log","options","mergeFileds","hasOwnProperty","strat","makeMap","str","tagList","split","tagNmae","includes","isReservedTag","initGlobalAPI","Vue","mixin","_base","extend","opt","Super","Sub","_init","prototype","constructor","component","id","definition","name","filter","directive","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","parserHTML","html","stack","root","createASTElement","tag","attrs","parent","type","children","start","length","element","end","tagName","pop","text","chars","replace","advance","len","substring","parseStartTag","match","attr","value","index","indexOf","startTagMatch","endTagMatch","defaultTagRE","genProps","i","styles","arguments","JSON","stringify","slice","gen","el","generate","test","lastIndex","tokens","exec","trim","join","genChildren","map","item","ast","code","compileToFunction","template","render","Function","toString","oldArrayPrototype","arrayMethods","methods","method","args","call","inserted","ob","__ob__","observeArray","Dep","vm","subs","depend","target","addDep","addSub","watcher","notify","update","Observer","defineProperty","enumerable","__proto__","walk","data","observe","keys","defineReactive","obj","dep","get","set","newValue","initState","opts","$options","initData","proxy","source","_data","queue","has","flushSchedulerQueue","run","pending","queueWatcher","Watcher","cb","depIds","Set","getter","deps","depId","add","createComponent","Ctor","init","vnode","child","componentInstance","$mount","prepatch","insert","destroy","componentVnode","undefined","createElement","createText","isSameVnode","oldVnode","newVnode","componentOptions","patch","createElm","isRealElement","nodeType","elm","parentNode","insertBefore","nextSibling","removeChild","replaceChild","textContent","updateProperties","oldChildren","newChildren","innerHTML","appendChild","updateChildren","oldStartIndex","oldStartVnode","oldEndIndex","oldEndVnode","newStartIndex","newStartVnode","newEndIndex","newEndVnode","makeKeyByIndex","mapping","moveIndex","moveVnode","anchor","$el","document","createTextNode","oldProps","newProps","newStyle","style","oldStyle","setAttribute","removeArttribute","mountComponent","updateComponent","_update","_render","callHook","lifecycleMixin","preVnode","_preVnode","handlers","handler","initMixin","querySelector","outerHTML","$nextTick","renderMixin","_c","_v","_s"],"mappings":"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"}