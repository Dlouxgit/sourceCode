{"version":3,"file":"vue.js","sources":["../src/compiler/parser.js","../src/compiler/generate.js","../src/compiler/index.js","../src/utils.js","../src/observe/array.js","../src/observe/index.js","../src/state.js","../src/observe/watcher.js","../src/lifecycle.js","../src/init.js","../src/render.js","../src/index.js"],"sourcesContent":["\r\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`; // 匹配标签名的  aa-xxx\r\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`; //  aa:aa-xxx  \r\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); //  此正则可以匹配到标签名 匹配到结果的第一个(索引第一个) [1]\r\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); // 匹配标签结尾的 </div>  [1]\r\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/; // 匹配属性的\r\n\r\n// [1]属性的key   [3] || [4] ||[5] 属性的值\r\n\r\nconst startTagClose = /^\\s*(\\/?)>/; // 匹配标签结束的  />    > \r\n\r\nexport function parserHTML(html) {\r\n    let stack = []\r\n    let root = null\r\n    function createASTElement(tag, attrs, parent = null) {\r\n        return {\r\n            tag,\r\n            type: 1,\r\n            children: [],\r\n            parent,\r\n            attrs\r\n        }\r\n    }\r\n        function start(tag,attrs){ // [div,p]\r\n        // 遇到开始标签 就取栈中的最后一个作为父节点\r\n        let parent = stack[stack.length-1];\r\n        let element = createASTElement(tag,attrs,parent);\r\n        if(root == null){ // 说明当前节点就是根节点\r\n            root = element\r\n        }\r\n        if(parent){\r\n            element.parent = parent; // 跟新p的parent属性 指向parent\r\n            parent.children.push(element);\r\n        }\r\n        stack.push(element)\r\n    }\r\n    function end(tagName) {\r\n        let endTag = stack.pop()\r\n        if (endTag.tag != tagName) {\r\n            console.log('标签错误')\r\n        }\r\n    }\r\n\r\n    function text(chars) {\r\n        let parent = stack[stack.length - 1]\r\n        chars = chars.replace(/\\s/g, '')\r\n        if (chars) {\r\n            parent.children.push({\r\n                type: 2, // 文本\r\n                text: chars\r\n            })\r\n        }\r\n    }\r\n\r\n    function advance(len) {\r\n        html = html.substring(len)\r\n    }\r\n    function parseStartTag() {\r\n        const start = html.match(startTagOpen)\r\n        if (start) {\r\n            const match = {\r\n                tagName: start[1],\r\n                attrs: []\r\n            }\r\n            advance(start[0].length)\r\n            let end\r\n            let attr\r\n            while (!(end = html.match(startTagClose)) && (attr = html.match(attribute))) {\r\n                match.attrs.push({\r\n                    name: attr[1],\r\n                    value: attr[3] || attr[4] || attr[5] // 属性可能为 height=1 height=\"1\" height='1'\r\n                })\r\n                advance(attr[0].length)\r\n            }\r\n            if (end) {\r\n                advance(end[0].length)\r\n            }\r\n            return match\r\n        }\r\n        return false\r\n    }\r\n    while (html) {\r\n        let index = html.indexOf('<')\r\n        if (index === 0) {\r\n            const startTagMatch = parseStartTag()\r\n            if (startTagMatch) {\r\n                start(startTagMatch.tagName, startTagMatch.attrs)\r\n                continue\r\n            }\r\n            let endTagMatch\r\n            if (endTagMatch = html.match(endTag)) {\r\n                end(endTagMatch[1])\r\n                advance(endTagMatch[0].length)\r\n                continue\r\n            }\r\n        }\r\n        if (index > 0) {\r\n            let chars = html.substring(0, index)\r\n            text(chars)\r\n            advance(chars.length)\r\n        }\r\n    }\r\n    console.log(root)\r\n    return root\r\n}","const defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g; // {{   xxx  }}  \r\n\r\nfunction genProps(attrs) {\r\n    let str = ''\r\n\r\n    for (let i = 0; i < attrs.length; i++) {\r\n        let attr = attrs[i]\r\n        if (attr.name === 'style') {\r\n            let styles = {}\r\n            attr.value.replace(/([^;:]+):([^;:]+)/g, function() {\r\n                styles[arguments[1]] = arguments[2];\r\n            })\r\n            attr.value = styles\r\n        }\r\n        str += `${attr.name}: ${JSON.stringify(attr.value)},`\r\n    }\r\n    return `{${str.slice(0, -1)}}`\r\n}\r\n\r\nfunction gen(el) {\r\n    if (el.type === 1) {\r\n        return generate(el)\r\n    } else {\r\n        let text = el.text\r\n        if (!defaultTagRE.test(text))\r\n            return `_v('${text}')`\r\n        let lastIndex = defaultTagRE.lastIndex = 0\r\n        let tokens = []\r\n        let match\r\n        while (match = defaultTagRE.exec(text)) {\r\n            let index = match.index\r\n            if (index > lastIndex) {\r\n                tokens.push(JSON.stringify(text.slice(lastIndex, index)))\r\n            }\r\n            tokens.push(`_s(${match[1].trim()})`)\r\n            lastIndex = index + match[0].length\r\n        }\r\n        if (lastIndex < text.length) {\r\n            tokens.push(JSON.stringify(text.slice(lastIndex)))\r\n        }\r\n        return `_v(${tokens.join('+')})`\r\n    }\r\n}\r\n\r\nfunction genChildren(el) {\r\n    let children = el.children\r\n    if (children) {\r\n        return children.map(item => gen(item)).join(',')\r\n    }\r\n    return false\r\n}\r\n\r\nexport function generate(ast) {\r\n    let children = genChildren(ast)\r\n    let code = `_c('${ast.tag}', ${\r\n        ast.attrs.length ? genProps(ast.attrs) : 'undefined'\r\n    })${\r\n        children? `,${children}` : ''\r\n    }`\r\n    return code\r\n}","import { parserHTML } from './parser'\r\nimport { generate } from './generate'\r\nexport function compileToFunction(template) {\r\n    let ast = parserHTML(template)\r\n    let code = generate(ast)\r\n    let render = new Function(`with(this){return ${code}}`)\r\n    console.log('redner', render.toString())\r\n}","export function isFunction(val) {\r\n    return typeof val === 'function'\r\n}\r\n\r\nexport function isObject(val) {\r\n    return typeof val === 'object' && val !== null\r\n}\r\n\r\nexport let isArray = Array.isArray","let oldArrayPrototype = Array.prototype\r\n\r\nexport let arrayMethods = Object.create(oldArrayPrototype)\r\n\r\nlet methods = [\r\n    'push',\r\n    'shift',\r\n    'pop',\r\n    'unshift',\r\n    'reverse',\r\n    'sort',\r\n    'splice'\r\n]\r\n\r\nmethods.forEach(method => {\r\n    arrayMethods[method] = function (...args) {\r\n        oldArrayPrototype[method].call(this, ...args)\r\n\r\n        let inserted = null\r\n        let ob = this.__ob__\r\n        switch (method) {\r\n            case 'splice':\r\n                inserted =  args.slice(2)\r\n                break\r\n            case 'push':\r\n            case 'shift':\r\n                inserted = args\r\n                break\r\n        }\r\n        if (inserted) ob.observeArray(inserted)\r\n    }\r\n})","import { isArray, isObject } from \"../utils\";\r\nimport { arrayMethods } from \"./array\";\r\n\r\n// 1.每个对象都有一个__proto__属性 它指向所属类的原型   fn.__proto__ = Function.prototype\r\n// 2.每个原型上都有一个constructor属性 指向 函数本身 Function.prototype.constrcutr = Function\r\nclass Observer {\r\n    constructor(value){\r\n        // 不让__ob__ 被遍历到\r\n        // value.__ob__ = this; // 我给对象和数组添加一个自定义属性\r\n        Object.defineProperty(value,'__ob__',{\r\n            value:this,\r\n            enumerable:false // 标识这个属性不能被列举出来，不能被循环到\r\n        })\r\n        if(isArray(value)){\r\n            // 更改数组原型方法, 如果是数组 我就改写数组的原型链\r\n            value.__proto__ = arrayMethods; // 重写数组的方法\r\n            this.observeArray(value);\r\n        }else{\r\n            this.walk(value); // 核心就是循环对象\r\n        }\r\n    }\r\n    observeArray(data){ // 递归遍历数组，对数组内部的对象再次重写 [[]]  [{}]\r\n        // vm.arr[0].a = 100;\r\n        // vm.arr[0] = 100;\r\n        data.forEach(item=> observe(item)); // 数组里面如果是引用类型那么是响应式的\r\n    }\r\n    walk(data){\r\n        Object.keys(data).forEach(key=>{ // 要使用defineProperty重新定义\r\n            defineReactive(data,key,data[key]);\r\n        });\r\n    }\r\n}\r\n// vue2 应用了defineProperty需要一加载的时候 就进行递归操作，所以好性能，如果层次过深也会浪费性能\r\n// 1.性能优化的原则：\r\n// 1) 不要把所有的数据都放在data中，因为所有的数据都会增加get和set\r\n// 2) 不要写数据的时候 层次过深， 尽量扁平化数据 \r\n// 3) 不要频繁获取数据\r\n// 4) 如果数据不需要响应式 可以使用Object.freeze 冻结属性 \r\nfunction defineReactive(obj,key,value){ // vue2 慢的原因 主要在这个方法中\r\n    observe(value); // 递归进行观测数据，不管有多少层 我都进行defineProperty\r\n    Object.defineProperty(obj,key,{\r\n        get(){ // 后续会有很多逻辑\r\n            return value; // 闭包，次此value 会像上层的value进行查找\r\n        },\r\n        set(newValue){  // 如果设置的是一个对象那么会再次进行劫持\r\n            if(newValue === value) return\r\n            observe(newValue);\r\n            console.log('修改')\r\n            value = newValue\r\n        }\r\n    })\r\n}\r\nexport function observe(value){\r\n    // 1.如果value不是对象，那么就不用观测了，说明写的有问题\r\n    if(!isObject(value)){\r\n        return;\r\n    }\r\n    if(value.__ob__){\r\n        return ; // 一个对象不需要重新被观测\r\n    }\r\n    // 需要对对象进行观测 （最外层必须是一个{} 不能是数组）\r\n\r\n    // 如果一个数据已经被观测过了 ，就不要在进行观测了， 用类来实现，我观测过就增加一个标识 说明观测过了，在观测的时候 可以先检测是否观测过，如果观测过了就跳过检测\r\n    return new Observer(value)\r\n}","import { observe } from './observe'\r\nimport { isFunction } from './utils'\r\n\r\nexport function initState(vm) {\r\n    const opts = vm.$options\r\n\r\n    if (opts.data) {\r\n        initData(vm)\r\n    }\r\n}\r\n\r\nfunction proxy(vm, key, source) {\r\n    Object.defineProperty(vm, key, {\r\n        get() {\r\n            return vm[source][key]\r\n        },\r\n        set(newValue) {\r\n            vm[source][key] = newValue\r\n        }\r\n    })\r\n}\r\n\r\nfunction initData(vm) {\r\n    let data = vm.$options.data\r\n    \r\n    data = vm._data = isFunction(data) ? data.call(vm) : data\r\n\r\n    observe(data)\r\n\r\n    for (let key in data) {\r\n        proxy(vm, key, '_data')\r\n    }\r\n}","import Dep from './dep'\r\n\r\nlet id = 0\r\nclass Watcher {\r\n    constructor(vm, fn, cb, options) {\r\n        this.vm = vm\r\n        this.fn = fn\r\n        this.cb = cb\r\n        this.options = options\r\n        this.id = id++\r\n        this.depIds = new Set()\r\n        this.getter = fn\r\n        this.deps = []\r\n        this.get()\r\n    }\r\n\r\n    addDep(dep) {\r\n        depId = dep.id\r\n        if (!this.depIds.has(depId)) {\r\n            this.depIds.add(depId)\r\n            this.deps.push(dep)\r\n            dep.subs.push(this)\r\n        }\r\n    }\r\n\r\n    get() {\r\n        Dep.target = this\r\n        this.getter()\r\n        Dep.target = null\r\n    }\r\n\r\n    update() {\r\n        this.get()\r\n    }\r\n}\r\n\r\nexport default Watcher","import Watcher from './observe/watcher'\r\n\r\nexport function mountComponent() {\r\n    const updateComponent = () => {\r\n        vm._update(vm._render())\r\n    }\r\n\r\n    new Watcher(vm, updateComponent, () => {\r\n        console.log('hook')\r\n    }, true)\r\n}\r\n\r\nexport function lifecycleMixin(Vue) {\r\n    Vue.prototype._update = function (vnode) {\r\n        const vm = this\r\n        vm.$el = patch(vm.$el, vnode)\r\n    }\r\n}","import { compileToFunction } from './compiler'\r\nimport { initState } from './state'\r\nimport { mountComponent } from './lifecycle'\r\n\r\nexport function initMixin(Vue) {\r\n    Vue.prototype._init = function (options) {\r\n        const vm = this\r\n        vm.$options = options\r\n\r\n        initState(vm)\r\n\r\n        if (vm.$options.el) {\r\n            console.log('页面挂载')\r\n            vm.$mount(vm.$options.el)\r\n        }\r\n    }\r\n    Vue.prototype.$mount = function (el) {\r\n        const vm = this\r\n        const opts = vm.$options\r\n        el = document.querySelector(el)\r\n        vm.$el = el\r\n        if (!vm.render) {\r\n            // 模板编译\r\n            let template = opts.template\r\n            \r\n            if (!template) {\r\n                let render = compileToFunction(el.outerHTML)\r\n                opts.render = render\r\n            }\r\n        }\r\n        mountComponent(vm)\r\n    }\r\n}\r\n","import { isObject } from './utils'\r\n\r\nexport function renderMixin(Vue) {\r\n    // 生成虚拟元素节点\r\n    Vue.prototype._c = function (...args) {\r\n        const vm = this\r\n        return createElement(vm, ...args)\r\n    }\r\n\r\n    // 生成虚拟文本节点\r\n    Vue.prototype._v = function (text) {\r\n        const vm = this\r\n        return createText(vm, text)\r\n    }\r\n\r\n    // 把属性变成字符串\r\n    Vue.prototype._s = function (val) {\r\n        if (isObject(val))\r\n            return JSON.stringify(val)\r\n        return val\r\n    }\r\n\r\n\r\n    Vue.prototype._render = function () {\r\n        const vm = this\r\n        const { render } = vm.$options\r\n        const vnode = render.call(vm)\r\n        return vnode\r\n    }\r\n}","import { initMixin } from './init'\r\nimport { renderMixin } from './render'\r\nimport { lifecycleMixin } from './lifecycle'\r\n\r\nfunction Vue(options) {\r\n    this._init(options)\r\n}\r\n\r\ninitMixin(Vue)\r\n\r\nrenderMixin(Vue)\r\n\r\nlifecycleMixin(Vue)\r\n\r\n\r\nexport default Vue"],"names":["ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","parserHTML","html","stack","root","createASTElement","tag","attrs","parent","type","children","start","length","element","push","end","tagName","pop","console","log","text","chars","replace","advance","len","substring","parseStartTag","match","attr","name","value","index","indexOf","startTagMatch","endTagMatch","defaultTagRE","genProps","str","i","styles","arguments","JSON","stringify","slice","gen","el","generate","test","lastIndex","tokens","exec","trim","join","genChildren","map","item","ast","code","compileToFunction","template","render","Function","toString","isFunction","val","isObject","isArray","Array","oldArrayPrototype","prototype","arrayMethods","Object","create","methods","forEach","method","args","call","inserted","ob","__ob__","observeArray","Observer","constructor","defineProperty","enumerable","__proto__","walk","data","observe","keys","key","defineReactive","obj","get","set","newValue","initState","vm","opts","$options","initData","proxy","source","_data","id","Watcher","fn","cb","options","depIds","Set","getter","deps","addDep","dep","depId","has","add","subs","update","mountComponent","updateComponent","_update","_render","lifecycleMixin","Vue","vnode","$el","patch","initMixin","_init","$mount","document","querySelector","outerHTML","renderMixin","_c","createElement","_v","createText","_s"],"mappings":"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"}